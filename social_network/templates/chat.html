{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <h1 class="mb-4">Chat with {{ other_user.username }}</h1>

    <div class="chat-box bg-light p-3 mb-4 border rounded" style="height: 400px; overflow-y: scroll;">
        {% for message in messages %}
        <div class="message {% if message.sender == request.user %}text-end{% else %}text-start{% endif %} mb-2">
            <div class="d-inline-block p-2 rounded {% if message.sender == request.user %}bg-primary text-white{% else %}bg-secondary text-white{% endif %}">
                <p class="mb-1"><strong>{{ message.sender.username }}</strong>: {{ message.content }}</p>
                <small>{{ message.timestamp|date:"H:i:s, d M Y" }}</small>
                <!-- Hiển thị trạng thái "Đã đọc" cho tin nhắn gửi đi -->
                {% if message.sender == request.user and message.is_read %}
                <span class="text-muted">Đã đọc</span>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>

    <form method="POST" class="d-flex">
        {% csrf_token %}
        <input type="text" name="content" class="form-control me-2" placeholder="Type your message..." required>
        <button type="submit" class="btn btn-primary">Send</button>
    </form>
</div>
{% endblock %}
